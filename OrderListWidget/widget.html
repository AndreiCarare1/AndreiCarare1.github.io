<!DOCTYPE html>
<html>
    <head>
        <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
        <style>
            .checkbox-list label {
                display: block;
            }
        </style>
    </head>
    <body>
        <div id="main">
            <h3>This is my first widget.</h3>
            <span id="labelText"></span>
            <div class="checkbox-list" id="checkboxList">
                <!-- Checkboxes will be added here -->
            </div>
        </div>
        <script type="text/javascript">
            JFCustomWidget.subscribe("ready", function(){
                var label = JFCustomWidget.getWidgetSetting('QuestionLabel');
                var options = JFCustomWidget.getWidgetSetting('options') || 'Option 1,Option 2,Option 3';
                var optionsArray = options.split(',');

                // Set the question label
                document.getElementById('labelText').innerHTML = label;
                
                // Add checkboxes
                var checkboxListDiv = document.getElementById('checkboxList');
                optionsArray.forEach(function(option, index) {
                    var container = document.createElement('label');
                    var checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = 'checkbox_' + index;
                    checkbox.name = 'checkboxes';
                    checkbox.value = option;
                    
                    var description = document.createTextNode(option);
                    
                    container.appendChild(checkbox);
                    container.appendChild(description);
                    
                    checkboxListDiv.appendChild(container);
                });

                // Subscribe to form submit event
                JFCustomWidget.subscribe("submit", function(){
                    var checkboxes = document.querySelectorAll('input[name="checkboxes"]:checked');
                    var selectedValues = Array.from(checkboxes).map(function(checkbox) {
                        return checkbox.value;
                    });

                    var isValid = selectedValues.length > 0; // or any other validation you would like to perform

                    var msg = {
                        valid: isValid,
                        value: selectedValues.join(', ') // or any other format you need
                    };

                    // Send value to JotForm
                    JFCustomWidget.sendSubmit(msg);
                });
            });
        </script>
    </body>
</html>
